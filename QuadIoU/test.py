from shapely.geometry import Polygon
import re

big_text = """{{{ {0, 0}, {300, 0}, {300, 300}, {0, 300} }}, {{ {0, 0}, {150, 0}, {150, 150}, {0, 150} }}},
{{{ {0, 0}, {300, 0}, {300, 300}, {0, 300} }}, {{ {500, 500}, {600, 600}, {700, 750}, {600, 750} }}},
{{{ {200, 200}, {500, 200}, {500, 500}, {200, 500} }}, {{ {300, 300}, {500, 200}, {500, 500}, {200, 500} }}},
{{{ {0, 0}, {300, 0}, {300, 300}, {0, 300} }}, {{ {10, 10}, {20, 10}, {20, 20}, {10, 20} }}},
{{{ {0, 0}, {300, 0}, {300, 300}, {0, 300} }}, {{ {10, 10}, {20, 10}, {20, 20}, {10, 20} }}},
{{{ {0, 0}, {350, 0}, {350, 350}, {0, 350} }}, {{ {15, 15}, {25, 15}, {25, 25}, {15, 25} }}},
{{{ {0, 0}, {400, 0}, {400, 400}, {0, 400} }}, {{ {30, 30}, {60, 30}, {60, 60}, {30, 60} }}},
{{{ {0, 0}, {450, 0}, {450, 450}, {0, 450} }}, {{ {40, 40}, {80, 40}, {80, 80}, {40, 80} }}},
{{{ {0, 0}, {500, 0}, {500, 500}, {0, 500} }}, {{ {50, 50}, {100, 50}, {100, 100}, {50, 100} }}},
{{{ {0, 0}, {550, 0}, {550, 550}, {0, 550} }}, {{ {5, 5}, {15, 5}, {15, 15}, {5, 15} }}},
{{{ {0, 0}, {600, 0}, {600, 600}, {0, 600} }}, {{ {20, 20}, {40, 20}, {40, 40}, {20, 40} }}},
{{{ {0, 0}, {650, 0}, {650, 650}, {0, 650} }}, {{ {25, 25}, {50, 25}, {50, 50}, {25, 50} }}},
{{{ {0, 0}, {700, 0}, {700, 700}, {0, 700} }}, {{ {10, 10}, {30, 10}, {30, 30}, {10, 30} }}},
{{{ {0, 0}, {750, 0}, {750, 750}, {0, 750} }}, {{ {35, 35}, {70, 35}, {70, 70}, {35, 70} }}},
{{{ {0, 0}, {800, 0}, {800, 800}, {0, 800} }}, {{ {45, 45}, {90, 45}, {90, 90}, {45, 90} }}},
{{{ {0, 0}, {850, 0}, {850, 850}, {0, 850} }}, {{ {55, 55}, {110, 55}, {110, 110}, {55, 110} }}},
{{{ {0, 0}, {900, 0}, {900, 900}, {0, 900} }}, {{ {60, 60}, {120, 60}, {120, 120}, {60, 120} }}},
{{{ {0, 0}, {950, 0}, {950, 950}, {0, 950} }}, {{ {65, 65}, {130, 65}, {130, 130}, {65, 130} }}},
{{{ {0, 0}, {1000, 0}, {1000, 1000}, {0, 1000} }}, {{ {70, 70}, {140, 70}, {140, 140}, {70, 140} }}},
{{{ {0, 0}, {1050, 0}, {1050, 1050}, {0, 1050} }}, {{ {75, 75}, {150, 75}, {150, 150}, {75, 150} }}},
{{{ {0, 0}, {1100, 0}, {1100, 1100}, {0, 1100} }}, {{ {80, 80}, {160, 80}, {160, 160}, {80, 160} }}},
{{{ {0, 0}, {1150, 0}, {1150, 1150}, {0, 1150} }}, {{ {85, 85}, {170, 85}, {170, 170}, {85, 170} }}},
{{{ {0, 0}, {350, 0}, {350, 350}, {0, 350} }}, {{ {15, 15}, {25, 15}, {25, 25}, {15, 25} }}},
{{{ {0, 0}, {400, 0}, {400, 400}, {0, 400} }}, {{ {30, 30}, {60, 30}, {60, 60}, {30, 60} }}},
{{{ {0, 0}, {450, 0}, {450, 450}, {0, 450} }}, {{ {40, 40}, {80, 40}, {80, 80}, {40, 80} }}},
{{{ {0, 0}, {500, 0}, {500, 500}, {0, 500} }}, {{ {50, 50}, {100, 50}, {100, 100}, {50, 100} }}},
{{{ {0, 0}, {550, 0}, {550, 550}, {0, 550} }}, {{ {5, 5}, {15, 5}, {15, 15}, {5, 15} }}},
{{{ {0, 0}, {600, 0}, {600, 600}, {0, 600} }}, {{ {20, 20}, {40, 20}, {40, 40}, {20, 40} }}},
{{{ {0, 0}, {650, 0}, {650, 650}, {0, 650} }}, {{ {25, 25}, {50, 25}, {50, 50}, {25, 50} }}},
{{{ {0, 0}, {700, 0}, {700, 700}, {0, 700} }}, {{ {10, 10}, {30, 10}, {30, 30}, {10, 30} }}},
{{{ {0, 0}, {750, 0}, {750, 750}, {0, 750} }}, {{ {35, 35}, {70, 35}, {70, 70}, {35, 70} }}},
{{{ {0, 0}, {800, 0}, {800, 800}, {0, 800} }}, {{ {45, 45}, {90, 45}, {90, 90}, {45, 90} }}},
{{{ {0, 0}, {850, 0}, {850, 850}, {0, 850} }}, {{ {55, 55}, {110, 55}, {110, 110}, {55, 110} }}},
{{{ {0, 0}, {900, 0}, {900, 900}, {0, 900} }}, {{ {60, 60}, {120, 60}, {120, 120}, {60, 120} }}},
{{{ {0, 0}, {950, 0}, {950, 950}, {0, 950} }}, {{ {65, 65}, {130, 65}, {130, 130}, {65, 130} }}},
{{{ {0, 0}, {1000, 0}, {1000, 1000}, {0, 1000} }}, {{ {70, 70}, {140, 70}, {140, 140}, {70, 140} }}},
{{{ {0, 0}, {1050, 0}, {1050, 1050}, {0, 1050} }}, {{ {75, 75}, {150, 75}, {150, 150}, {75, 150} }}},
{{{ {0, 0}, {1100, 0}, {1100, 1100}, {0, 1100} }}, {{ {80, 80}, {160, 80}, {160, 160}, {80, 160} }}},
{{{ {20, 200}, {200, 20}, {240, 130}, {150, 400} }}, {{ {130, 40}, {220, 300}, {220, 375}, {130, 215}}}},
"""

# First, remove all the comments from the text
big_text = re.sub(r'//.*', '', big_text)

# Then find all the coordinate groups
groups = re.findall(r'\{\{([\s\S]*?)\}\}', big_text)

# Now process each group to extract the coordinates
coordinates_list = []
for group in groups:
    # Find all the coordinate pairs in the current group
    coords = re.findall(r'\{([\d\s,]+)\}', group)
    # Convert string coordinate pairs to tuples of integers
    coords = [tuple(map(int, coord.split(','))) for coord in coords]
    coordinates_list.append(coords)


for i in range(0, len(coordinates_list), 2):
    polygon1 = Polygon(coordinates_list[i])
    polygon2 = Polygon(coordinates_list[i + 1])
    intersect = polygon1.intersection(polygon2).area
    print(int(intersect))

coordinates_list[-1]
coordinates_list[-2]
# iou = intersect / union
# print(iou)  # iou = 0.5

# {{{ {0, 0}, {300, 0}, {300, 300}, {0, 300} }}, {{ {10, 10}, {20, 10}, {20, 20}, {10, 20} }}},